(function(e,c,a,h){var d="treeview";var g={injectStyle:true,levels:2,expandIcon:"glyphicon glyphicon-plus",collapseIcon:"glyphicon glyphicon-minus",emptyIcon:"glyphicon",nodeIcon:"glyphicon glyphicon-stop",color:h,backColor:h,borderColor:h,onhoverColor:"#F5F5F5",selectedColor:"#FFFFFF",selectedBackColor:"#428bca",searchResultColor:"#D9534F",searchResultBackColor:h,enableLinks:true,highlightSelected:true,highlightSearchResults:true,showBorder:true,showTags:true,multiSelect:false,onNodeCollapsed:h,onNodeExpanded:h,onNodeSelected:h,onNodeUnselected:h,onSearchComplete:h,onSearchCleared:h};var f=function(j,i){this.$element=e(j);this.elementId=j.id;this.styleId=this.elementId+"-style";this.init(i);return{options:this.options,init:e.proxy(this.init,this),remove:e.proxy(this.remove,this),getNode:e.proxy(this.getNode,this),getParent:e.proxy(this.getParent,this),getSiblings:e.proxy(this.getSiblings,this),selectNode:e.proxy(this.selectNode,this),unselectNode:e.proxy(this.unselectNode,this),toggleNodeSelected:e.proxy(this.toggleNodeSelected,this),collapseAll:e.proxy(this.collapseAll,this),collapseNode:e.proxy(this.collapseNode,this),expandAll:e.proxy(this.expandAll,this),expandNode:e.proxy(this.expandNode,this),toggleNodeExpanded:e.proxy(this.toggleNodeExpanded,this),search:e.proxy(this.search,this),clearSearch:e.proxy(this.clearSearch,this)}};f.prototype.init=function(i){this.tree=[];this.nodes=[];if(i.data){if(typeof i.data==="string"){i.data=e.parseJSON(i.data)}this.tree=e.extend(true,[],i.data);delete i.data}this.options=e.extend({},g,i);this.destroy();this.subscribeEvents();this.setInitialStates({nodes:this.tree},0);this.render()};f.prototype.remove=function(){this.destroy();e.removeData(this,d);e("#"+this.styleId).remove()};f.prototype.destroy=function(){if(!this.initialized){return}this.$wrapper.remove();this.$wrapper=null;this.unsubscribeEvents();this.initialized=false};f.prototype.unsubscribeEvents=function(){this.$element.off("click");if(typeof(this.options.onNodeCollapsed)==="function"){this.$element.off("nodeCollapsed")}if(typeof(this.options.onNodeExpanded)==="function"){this.$element.off("nodeExpanded")}if(typeof(this.options.onNodeSelected)==="function"){this.$element.off("nodeSelected")}if(typeof(this.options.onNodeUnselected)==="function"){this.$element.off("nodeUnselected")}if(typeof(this.options.onSearchComplete)==="function"){this.$element.off("searchComplete")}if(typeof(this.options.onSearchCleared)==="function"){this.$element.off("searchCleared")}};f.prototype.subscribeEvents=function(){this.unsubscribeEvents();this.$element.on("click",e.proxy(this.clickHandler,this));if(typeof(this.options.onNodeCollapsed)==="function"){this.$element.on("nodeCollapsed",this.options.onNodeCollapsed)}if(typeof(this.options.onNodeExpanded)==="function"){this.$element.on("nodeExpanded",this.options.onNodeExpanded)}if(typeof(this.options.onNodeSelected)==="function"){this.$element.on("nodeSelected",this.options.onNodeSelected)}if(typeof(this.options.onNodeUnselected)==="function"){this.$element.on("nodeUnselected",this.options.onNodeUnselected)}if(typeof(this.options.onSearchComplete)==="function"){this.$element.on("searchComplete",this.options.onSearchComplete)}if(typeof(this.options.onSearchCleared)==="function"){this.$element.on("searchCleared",this.options.onSearchCleared)}};f.prototype.setInitialStates=function(k,m){if(!k.nodes){return}m+=1;var i=k;var l=this;e.each(k.nodes,function j(n,o){o.nodeId=l.nodes.length;o.parentId=i.nodeId;if(!o.hasOwnProperty("selectable")){o.selectable=true}o.state=o.state||{};if(!o.state.hasOwnProperty("expanded")){if(m<l.options.levels){o.state.expanded=true}else{o.state.expanded=false}}if(!o.state.hasOwnProperty("selected")){o.state.selected=false}l.nodes.push(o);if(o.nodes){l.setInitialStates(o,m)}})};f.prototype.clickHandler=function(j){if(!this.options.enableLinks){j.preventDefault()}var k=e(j.target),l=k.attr("class")?k.attr("class").split(" "):[],i=this.findNode(k);if((l.indexOf("click-expand")!=-1)||(l.indexOf("click-collapse")!=-1)){this.toggleExpandedState(i)}else{if(i){if(i.selectable){this.toggleSelectedState(i)}else{this.toggleExpandedState(i)}}}};f.prototype.findNode=function(j){var k=j.closest("li.list-group-item").attr("data-nodeid"),i=this.nodes[k];if(!i){console.log("Error: node does not exist")}return i};f.prototype.toggleExpandedState=function(j,i){if(!j){return}this.setExpandedState(j,!j.state.expanded,i);this.render()};f.prototype.setExpandedState=function(j,k,i){if(k){j.state.expanded=true;if(!i){this.$element.trigger("nodeExpanded",e.extend(true,{},j))}}else{j.state.expanded=false;if(!i){this.$element.trigger("nodeCollapsed",e.extend(true,{},j))}}};f.prototype.toggleSelectedState=function(j,i){if(!j){return}this.setSelectedState(j,!j.state.selected,i);this.render()};f.prototype.setSelectedState=function(j,k,i){if(k){if(!this.options.multiSelect){e.each(this.findNodes("true","g","state.selected"),e.proxy(function(l,m){this.setSelectedState(m,false,i)},this))}j.state.selected=true;if(!i){this.$element.trigger("nodeSelected",e.extend(true,{},j))}}else{j.state.selected=false;if(!i){this.$element.trigger("nodeUnselected",e.extend(true,{},j))}}};f.prototype.render=function(){if(!this.initialized){this.$element.addClass(d);this.$wrapper=e(this.template.list);this.injectStyle();this.initialized=true}this.$element.empty().append(this.$wrapper.empty());this.buildTree(this.tree,0)};f.prototype.buildTree=function(j,l){if(!j){return}l+=1;var k=this;e.each(j,function i(q,o){var p=e(k.template.item).addClass("node-"+k.elementId).addClass(o.state.selected?"node-selected":"").addClass(o.searchResult?"search-result":"").attr("data-nodeid",o.nodeId).attr("style",k.buildStyleOverride(o));for(var n=0;n<(l-1);n++){p.append(k.template.indent)}if(o.nodes){if(!o.state.expanded){p.append(e(k.template.expandCollapseIcon).addClass("click-expand").addClass(k.options.expandIcon))}else{p.append(e(k.template.expandCollapseIcon).addClass("click-collapse").addClass(k.options.collapseIcon))}}else{p.append(e(k.template.expandCollapseIcon).addClass(k.options.emptyIcon))}p.append(e(k.template.icon).addClass(o.icon?o.icon:k.options.nodeIcon));if(k.options.enableLinks){p.append(e(k.template.link).attr("href",o.href).append(o.text))}else{p.append(o.text)}if(k.options.showTags&&o.tags){e.each(o.tags,function m(s,r){p.append(e(k.template.badge).append(r))})}k.$wrapper.append(p);if(o.nodes&&o.state.expanded){return k.buildTree(o.nodes,l)}})};f.prototype.buildStyleOverride=function(k){var j=k.color;var i=k.backColor;if(this.options.highlightSelected&&k.state.selected){if(this.options.selectedColor){j=this.options.selectedColor}if(this.options.selectedBackColor){i=this.options.selectedBackColor}}if(this.options.highlightSearchResults&&k.searchResult){if(this.options.searchResultColor){j=this.options.searchResultColor}if(this.options.searchResultBackColor){i=this.options.searchResultBackColor}}return"color:"+j+";background-color:"+i+";"};f.prototype.injectStyle=function(){if(this.options.injectStyle&&!a.getElementById(this.styleId)){e('<style type="text/css" id="'+this.styleId+'"> '+this.buildStyle()+" </style>").appendTo("head")}};f.prototype.buildStyle=function(){var i=".node-"+this.elementId+"{";if(this.options.color){i+="color:"+this.options.color+";"}if(this.options.backColor){i+="background-color:"+this.options.backColor+";"}if(!this.options.showBorder){i+="border:none;"}else{if(this.options.borderColor){i+="border:1px solid "+this.options.borderColor+";"}}i+="}";if(this.options.onhoverColor){i+=".node-"+this.elementId+":hover{background-color:"+this.options.onhoverColor+";}"}return this.css+i};f.prototype.template={list:'<ul class="list-group"></ul>',item:'<li class="list-group-item"></li>',indent:'<span class="indent"></span>',expandCollapseIcon:'<span class="expand-collapse"></span>',icon:'<span class="icon"></span>',link:'<a href="#" style="color:inherit;"></a>',badge:'<span class="badge"></span>'};f.prototype.css=".treeview .list-group-item{cursor:pointer}.treeview span.indent{margin-left:10px;margin-right:10px}.treeview span.expand-collapse{width:1rem;height:1rem}.treeview span.icon{margin-left:10px;margin-right:5px}";f.prototype.getNode=function(i){return this.nodes[i]};f.prototype.getParent=function(i){var j=this.identifyNode(i);return this.nodes[j.parentId]};f.prototype.getSiblings=function(j){var l=this.identifyNode(j);var k=this.getParent(l);var i=k?k.nodes:this.tree;return i.filter(function(m){return m.nodeId!==l.nodeId})};f.prototype.selectNode=function(k,j){var i=this.isSilent(j);this.setSelectedState(this.identifyNode(k),true,i);this.render()};f.prototype.unselectNode=function(k,j){var i=this.isSilent(j);this.setSelectedState(this.identifyNode(k),false,i);this.render()};f.prototype.toggleNodeSelected=function(j,i){this.toggleSelectedState(this.identifyNode(j),this.isSilent(i))};f.prototype.collapseAll=function(j){var i=this.isSilent(j);e.each(this.nodes,e.proxy(function(k,l){this.setExpandedState(l,false,i)},this));this.render()};f.prototype.collapseNode=function(k,j){var i=this.isSilent(j);this.setExpandedState(this.identifyNode(k),false,i);this.render()};f.prototype.expandAll=function(j){var i=this.isSilent(j);if(j&&j.levels){this.expandLevels(this.tree,j.levels,i)}else{e.each(this.nodes,e.proxy(function(k,l){this.setExpandedState(l,true,i)},this))}this.render()};f.prototype.expandNode=function(k,j){var i=this.isSilent(j);var l=this.identifyNode(k);this.setExpandedState(l,true,i);if(l.nodes&&(j&&j.levels)){this.expandLevels(l.nodes,j.levels-1,i)}this.render()};f.prototype.expandLevels=function(j,k,i){e.each(j,e.proxy(function(l,m){this.setExpandedState(m,(k>0)?true:false);if(m.nodes){this.expandLevels(m.nodes,k-1,i)}},this))};f.prototype.toggleNodeExpanded=function(j,i){this.toggleExpandedState(this.identifyNode(j),this.isSilent(i))};f.prototype.identifyNode=function(i){return((typeof i)==="number")?this.nodes[i]:i};f.prototype.isSilent=function(i){return(i&&i.hasOwnProperty("silent"))?i.silent:false};f.prototype.search=function(l,j){this.clearSearch();var k=[];if(l&&l.length>0){if(j.exactMatch){l="^"+l+"$"}var i="g";if(j.ignoreCase){i+="i"}k=this.findNodes(l,i);e.each(k,function(m,n){n.searchResult=true});this.render()}this.$element.trigger("searchComplete",e.extend(true,{},k));return k};f.prototype.clearSearch=function(){var i=e.each(this.findNodes("true","g","searchResult"),function(j,k){k.searchResult=false});this.render();this.$element.trigger("searchCleared",e.extend(true,{},i))};f.prototype.findNodes=function(k,i,j){i=i||"g";j=j||"text";var l=this;return e.grep(this.nodes,function(m){var n=l.getNodeValue(m,j);if(typeof n==="string"){return n.match(new RegExp(k,i))}})};f.prototype.getNodeValue=function(k,i){var j=i.indexOf(".");if(j>0){var m=k[i.substring(0,j)];var l=i.substring(j+1,i.length);return this.getNodeValue(m,l)}else{if(k.hasOwnProperty(i)){return k[i].toString()}else{return h}}};var b=function(i){if(c.console){c.console.error(i)}};e.fn[d]=function(k,j){var i;this.each(function(){var l=e.data(this,d);if(typeof k==="string"){if(!l){b("Not initialized, can not call method : "+k)}else{if(!e.isFunction(l[k])||k.charAt(0)==="_"){b("No such method : "+k)}else{if(!(j instanceof Array)){j=[j]}i=l[k].apply(l,j)}}}else{if(typeof k==="boolean"){i=l}else{e.data(this,d,new f(this,e.extend(true,{},k)))}}});return i||this}})(jQuery,window,document);